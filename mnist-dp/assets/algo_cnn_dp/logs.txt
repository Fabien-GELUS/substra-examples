(venv_dp) fabien@LAPTOP-FAB:~/workspace/substra-examples-dp/mnist-dp$ python assets/algo_cnn/algo.py train   --debug   --opener-path assets/dataset/opener.py   --data-samples-path assets/train_data   --output-model-path assets/model/model   --log-path assets/logs/train.logsubstratools.utils - Module 'opener' loaded from path 'assets/dataset/opener.py'
substratools.opener - loading X from '['assets/train_data/features', 'assets/train_data/labels']'
Finding features file...
Loading features...
substratools.opener - loading y from '['assets/train_data/features', 'assets/train_data/labels']'
Finding label file...
Loading labels...
substratools.algo - launching training task
X shape: (60000, 28, 28, 1)
Train on 60000 samples
2020-08-06 14:43:07.901701: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2020-08-06 14:43:07.907117: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2495995000 Hz
2020-08-06 14:43:07.907777: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x4aa25c0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-08-06 14:43:07.907820: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
60000/60000 [==============================] - 834s 14ms/sample - loss: 1.9815 - acc: 0.5579
DP-SGD with sampling rate = 0.417% and noise_multiplier = 1.3 iterated over 240 steps satisfies differential privacy with eps = 0.685 and delta = 1.6666666666666667e-05.
The optimal RDP order is 18.0.
(0.6848896840269731, 18.0)
substratools.algo - saving output model to 'assets/model/model'

(venv_dp) fabien@LAPTOP-FAB:~/workspace/substra-examples-dp/mnist-dp$ python assets/algo_cnn/algo.py predict \
>   --debug \
>   --opener-path assets/dataset/opener.py \
>   --data-samples-path assets/test_data \
>   --output-predictions-path assets/pred-test.npy \
>   --models-path assets/model/ \
>   --log-path assets/logs/test_predict.log \
>   model
substratools.utils - Module 'opener' loaded from path 'assets/dataset/opener.py'
substratools.opener - loading X from '['assets/test_data/features', 'assets/test_data/labels']'
Finding features file...
Loading features...
substratools.algo - loading model from 'assets/model/model'
2020-08-06 15:08:35.235066: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2020-08-06 15:08:35.246840: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2495995000 Hz
2020-08-06 15:08:35.248768: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x4fecee0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-08-06 15:08:35.248841: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
substratools.algo - launching predict task
X shape: (10000, 28, 28, 1)
substratools.opener - saving predictions to 'assets/pred-test.npy'
(venv_dp) fabien@LAPTOP-FAB:~/workspace/substra-examples-dp/mnist-dp$ python assets/objective/metrics.py \
>   --debug \
>   --opener-path assets/dataset/opener.py \
>   --data-samples-path assets/test_data \
>   --input-predictions-path assets/pred-test.npy \
>   --output-perf-path assets/perf-test.json \
>   --log-path assets/logs/test_metrics.log
substratools.opener - loading y from '['assets/test_data/features', 'assets/test_data/labels']'
Finding label file...
Loading labels...
substratools.opener - loading predictions from 'assets/pred-test.npy'
substratools.metrics - launching scoring task
substratools.metrics - score: 0.8277
substratools.metrics - saving score to 'assets/perf-test.json'
